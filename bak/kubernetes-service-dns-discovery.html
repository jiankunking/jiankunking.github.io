<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="true">
  <meta name="msvalidate.01" content="true">
  <meta name="baidu-site-verification" content="true">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"jiankunking.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","width":320,"display":"hide","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":false,"style":"default"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":true,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":true},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Kubernetes Service、DNS与服务发现 TODO 未写完">
<meta name="keywords" content="Kubernetes,Service,DNS,Discovery">
<meta property="og:type" content="website">
<meta property="og:title" content="Kubernetes Service">
<meta property="og:url" content="https://jiankunking.com/bak/kubernetes-service-dns-discovery.html">
<meta property="og:site_name" content="衣舞晨风">
<meta property="og:description" content="Kubernetes Service、DNS与服务发现 TODO 未写完">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2023-08-24T07:08:52.853Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Kubernetes Service">
<meta name="twitter:description" content="Kubernetes Service、DNS与服务发现 TODO 未写完">

<link rel="canonical" href="https://jiankunking.com/bak/kubernetes-service-dns-discovery.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Kubernetes Service | 衣舞晨风
</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-121070942-1"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-121070942-1');
      }
    </script>


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?3a234fd6ba55e88f18fe2d8e55dd52c5";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">衣舞晨风</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">155</span></a>

  </li>
        <li class="menu-item menu-item-书籍">

    <a href="/books/" rel="section"><i class="fa fa-th fa-fw"></i>书籍</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">212</span></a>

  </li>
        <li class="menu-item menu-item-友链">

    <a href="/links/" rel="section"><i class="fa fa-external-link-alt fa-fw"></i>友链</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/jiankunking" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
  
  

          <div class="content page posts-expand">
            

    
    
    
    <div class="post-block" lang="zh-CN">
      <header class="post-header">

<h1 class="post-title" itemprop="name headline">Kubernetes Service
</h1>

<div class="post-meta">
  

</div>

</header>

      
      
      
      <div class="post-body">
          <p>Kubernetes Service、DNS与服务发现</p>
<p>TODO 未写完</p>
<a id="more"></a>
<p>大体的流程大家基本都清楚：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Service -&gt; ClusterIP -&gt; Pod N</span><br></pre></td></tr></table></figure>
<p>下面先看一下最小单位Pod的定义：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: v1</span><br><span class="line">kind: Pod</span><br><span class="line">metadata:</span><br><span class="line">  annotations:</span><br><span class="line">    cni.projectcalico.org/podIP: 10.230.6.219/32</span><br><span class="line">    helm.sh/namespace: console-dev</span><br><span class="line">    helm.sh/path: app</span><br><span class="line">    helm.sh/release: log-search</span><br><span class="line">    kubernetes.io/psp: 50-default</span><br><span class="line">    v1.multus-cni.io/default-network: k8s-pod-network</span><br><span class="line">  creationTimestamp: 2021-03-26T03:15:18Z</span><br><span class="line">  generateName: log-search-67847b4fb4-</span><br><span class="line">  labels:</span><br><span class="line">    app: log-search</span><br><span class="line">    controller.jiankunking.io/chart: app</span><br><span class="line">    controller.jiankunking.io/name: log-search</span><br><span class="line">    controller.jiankunking.io/release: log-search</span><br><span class="line">    pod-template-hash: 67847b4fb4</span><br><span class="line">    project: console</span><br><span class="line">    version: v1</span><br><span class="line">  name: log-search-67847b4fb4-4pdsl</span><br><span class="line">  namespace: console-dev</span><br><span class="line">  ownerReferences:</span><br><span class="line">  - apiVersion: apps/v1</span><br><span class="line">    blockOwnerDeletion: true</span><br><span class="line">    controller: true</span><br><span class="line">    kind: ReplicaSet</span><br><span class="line">    name: log-search-67847b4fb4</span><br><span class="line">    uid: 6c7c7bd6-77e2-11eb-bea8-20677ce70b1c</span><br><span class="line">  resourceVersion: &quot;261129631&quot;</span><br><span class="line">  selfLink: /api/v1/namespaces/console-dev/pods/log-search-67847b4fb4-4pdsl</span><br><span class="line">  uid: 7dc9efd2-8de1-11eb-bea8-20677ce70b1c</span><br><span class="line">spec:</span><br><span class="line">  containers:</span><br><span class="line">  - command:</span><br><span class="line">    - java</span><br><span class="line">    - -server</span><br><span class="line">    - -XX:+UseZGC</span><br><span class="line">    - -Xmx400m</span><br><span class="line">    - -jar</span><br><span class="line">    - app.jar</span><br><span class="line">    env:</span><br><span class="line">    - name: POD_NAMESPACE</span><br><span class="line">      valueFrom:</span><br><span class="line">        fieldRef:</span><br><span class="line">          apiVersion: v1</span><br><span class="line">          fieldPath: metadata.namespace</span><br><span class="line">    - name: POD_NAME</span><br><span class="line">      valueFrom:</span><br><span class="line">        fieldRef:</span><br><span class="line">          apiVersion: v1</span><br><span class="line">          fieldPath: metadata.name</span><br><span class="line">    - name: POD_IP</span><br><span class="line">      valueFrom:</span><br><span class="line">        fieldRef:</span><br><span class="line">          apiVersion: v1</span><br><span class="line">          fieldPath: status.podIP</span><br><span class="line">    - name: NODE_NAME</span><br><span class="line">      valueFrom:</span><br><span class="line">        fieldRef:</span><br><span class="line">          apiVersion: v1</span><br><span class="line">          fieldPath: spec.nodeName</span><br><span class="line">    - name: APP_NAME</span><br><span class="line">      valueFrom:</span><br><span class="line">        fieldRef:</span><br><span class="line">          apiVersion: v1</span><br><span class="line">          fieldPath: metadata.labels[&apos;controller.jiankunking.io/release&apos;]</span><br><span class="line">    - name: HOST_IP</span><br><span class="line">      valueFrom:</span><br><span class="line">        fieldRef:</span><br><span class="line">          apiVersion: v1</span><br><span class="line">          fieldPath: status.hostIP</span><br><span class="line">    - name: TENANT_NAME</span><br><span class="line">      value: console</span><br><span class="line">    - name: DEPLOY_ENV</span><br><span class="line">      value: dev</span><br><span class="line">    - name: SW_AGENT_NAME</span><br><span class="line">      value: console#log-search#dev</span><br><span class="line">    - name: CLUSTER_NAME</span><br><span class="line">      value: qd-ctcc</span><br><span class="line">    - name: SW_AGENT_COLLECTOR_BACKEND_HOST</span><br><span class="line">      value: oap.apm.jiankunking.net</span><br><span class="line">    - name: SW_AGENT_COLLECTOR_BACKEND_SERVICES</span><br><span class="line">      value: oap.apm.jiankunking.net:26733</span><br><span class="line">    envFrom:</span><br><span class="line">    - configMapRef:</span><br><span class="line">        name: console-dev.log-search.v19</span><br><span class="line">    image: registry.jiankunking.net/console_gitlab/log-search:v1.0.30-v2</span><br><span class="line">    imagePullPolicy: Always</span><br><span class="line">    name: c0</span><br><span class="line">    readinessProbe:</span><br><span class="line">      failureThreshold: 3</span><br><span class="line">      httpGet:</span><br><span class="line">        path: /api/v1/cat/test</span><br><span class="line">        port: 8080</span><br><span class="line">        scheme: HTTP</span><br><span class="line">      initialDelaySeconds: 60</span><br><span class="line">      periodSeconds: 10</span><br><span class="line">      successThreshold: 1</span><br><span class="line">      timeoutSeconds: 1</span><br><span class="line">    resources:</span><br><span class="line">      limits:</span><br><span class="line">        cpu: 300m</span><br><span class="line">        memory: 800Mi</span><br><span class="line">      requests:</span><br><span class="line">        cpu: 100m</span><br><span class="line">        memory: 500Mi</span><br><span class="line">    securityContext:</span><br><span class="line">      allowPrivilegeEscalation: false</span><br><span class="line">      privileged: false</span><br><span class="line">      procMount: Default</span><br><span class="line">    terminationMessagePath: /dev/termination-log</span><br><span class="line">    terminationMessagePolicy: File</span><br><span class="line">    volumeMounts:</span><br><span class="line">    - mountPath: /var/run/secrets/kubernetes.io/serviceaccount</span><br><span class="line">      name: default-token-ns4gc</span><br><span class="line">      readOnly: true</span><br><span class="line">  dnsPolicy: ClusterFirst</span><br><span class="line">  imagePullSecrets:</span><br><span class="line">  - name: ips-shun-guang-jing-xiang-cang-ku-vbdomzk-console-dev</span><br><span class="line">  - name: ips-ri-ri-shun-jing-xiang-cang-ku-uprsuyh-console-dev</span><br><span class="line">  - name: ips-dtsjing-xiang-cang-ku-vzglqrv-console-dev</span><br><span class="line">  - name: ips-default-console-dev</span><br><span class="line">  - name: ips-bei-jing-jing-xiang-cang-ku-dgougue-console-dev</span><br><span class="line">  nodeName: kube-node-10-133-0-121</span><br><span class="line">  restartPolicy: Always</span><br><span class="line">  schedulerName: default-scheduler</span><br><span class="line">  securityContext:</span><br><span class="line">    runAsNonRoot: false</span><br><span class="line">  serviceAccount: default</span><br><span class="line">  serviceAccountName: default</span><br><span class="line">  terminationGracePeriodSeconds: 30</span><br><span class="line">  volumes:</span><br><span class="line">  - name: default-token-ns4gc</span><br><span class="line">    secret:</span><br><span class="line">      defaultMode: 420</span><br><span class="line">      secretName: default-token-ns4gc</span><br><span class="line">status:</span><br><span class="line">  conditions:</span><br><span class="line">  - lastProbeTime: null</span><br><span class="line">    lastTransitionTime: 2021-03-26T03:15:18Z</span><br><span class="line">    status: &quot;True&quot;</span><br><span class="line">    type: Initialized</span><br><span class="line">  - lastProbeTime: null</span><br><span class="line">    lastTransitionTime: 2021-03-26T03:17:10Z</span><br><span class="line">    status: &quot;True&quot;</span><br><span class="line">    type: Ready</span><br><span class="line">  - lastProbeTime: null</span><br><span class="line">    lastTransitionTime: 2021-03-26T03:17:10Z</span><br><span class="line">    status: &quot;True&quot;</span><br><span class="line">    type: ContainersReady</span><br><span class="line">  - lastProbeTime: null</span><br><span class="line">    lastTransitionTime: 2021-03-26T03:15:18Z</span><br><span class="line">    status: &quot;True&quot;</span><br><span class="line">    type: PodScheduled</span><br><span class="line">  containerStatuses:</span><br><span class="line">  - containerID: docker://ff37b2dbb1e4a124125f7790ccca286b376ee11ff60f8bbbb49baf956280d45e</span><br><span class="line">    image: registry.jiankunking.net/console_gitlab/log-search:v1.0.30-v2</span><br><span class="line">    imageID: docker-pullable://registry.jiankunking.net/console_gitlab/log-search@sha256:46a08906de56ce6e5a200f2f985d9cea10ce90af86cb55ff92f94f732471f983</span><br><span class="line">    lastState: &#123;&#125;</span><br><span class="line">    name: c0</span><br><span class="line">    ready: true</span><br><span class="line">    restartCount: 0</span><br><span class="line">    state:</span><br><span class="line">      running:</span><br><span class="line">        startedAt: 2021-03-26T03:15:20Z</span><br><span class="line">  hostIP: 10.133.0.121</span><br><span class="line">  phase: Running</span><br><span class="line">  podIP: 10.230.6.219</span><br><span class="line">  qosClass: Burstable</span><br><span class="line">  startTime: 2021-03-26T03:15:18Z</span><br></pre></td></tr></table></figure>
<p>从Pod定义中可以看到该Pod是由Replica Set:log-search-67847b4fb4，下面看一下log-search-67847b4fb4的定义：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: extensions/v1beta1</span><br><span class="line">kind: ReplicaSet</span><br><span class="line">metadata:</span><br><span class="line">  annotations:</span><br><span class="line">    deployment.kubernetes.io/desired-replicas: &quot;2&quot;</span><br><span class="line">    deployment.kubernetes.io/max-replicas: &quot;3&quot;</span><br><span class="line">    deployment.kubernetes.io/revision: &quot;111&quot;</span><br><span class="line">    deployment.kubernetes.io/revision-history: &quot;108&quot;</span><br><span class="line">    helm.sh/namespace: console-dev</span><br><span class="line">    helm.sh/path: app</span><br><span class="line">    helm.sh/release: log-search</span><br><span class="line">  creationTimestamp: 2021-02-26T03:26:33Z</span><br><span class="line">  generation: 6</span><br><span class="line">  labels:</span><br><span class="line">    app: log-search</span><br><span class="line">    controller.jiankunking.io/chart: app</span><br><span class="line">    controller.jiankunking.io/name: log-search</span><br><span class="line">    controller.jiankunking.io/release: log-search</span><br><span class="line">    pod-template-hash: 67847b4fb4</span><br><span class="line">    version: v1</span><br><span class="line">  name: log-search-67847b4fb4</span><br><span class="line">  namespace: console-dev</span><br><span class="line">  ownerReferences:</span><br><span class="line">  - apiVersion: apps/v1</span><br><span class="line">    blockOwnerDeletion: true</span><br><span class="line">    controller: true</span><br><span class="line">    kind: Deployment</span><br><span class="line">    name: log-search</span><br><span class="line">    uid: b8c61330-3780-11ea-b6c2-20677ce70b1c</span><br><span class="line">  resourceVersion: &quot;261129633&quot;</span><br><span class="line">  selfLink: /apis/extensions/v1beta1/namespaces/console-dev/replicasets/log-search-67847b4fb4</span><br><span class="line">  uid: 6c7c7bd6-77e2-11eb-bea8-20677ce70b1c</span><br><span class="line">spec:</span><br><span class="line">  replicas: 2</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      app: log-search</span><br><span class="line">      controller.jiankunking.io/chart: app</span><br><span class="line">      controller.jiankunking.io/name: log-search</span><br><span class="line">      controller.jiankunking.io/release: log-search</span><br><span class="line">      pod-template-hash: 67847b4fb4</span><br><span class="line">      version: v1</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      annotations:</span><br><span class="line">        helm.sh/namespace: console-dev</span><br><span class="line">        helm.sh/path: app</span><br><span class="line">        helm.sh/release: log-search</span><br><span class="line">        v1.multus-cni.io/default-network: k8s-pod-network</span><br><span class="line">      creationTimestamp: null</span><br><span class="line">      labels:</span><br><span class="line">        app: log-search</span><br><span class="line">        controller.jiankunking.io/chart: app</span><br><span class="line">        controller.jiankunking.io/name: log-search</span><br><span class="line">        controller.jiankunking.io/release: log-search</span><br><span class="line">        pod-template-hash: 67847b4fb4</span><br><span class="line">        version: v1</span><br><span class="line">    spec:</span><br><span class="line">      containers:</span><br><span class="line">      - command:</span><br><span class="line">        - java</span><br><span class="line">        - -server</span><br><span class="line">        - -XX:+UseZGC</span><br><span class="line">        - -Xmx400m</span><br><span class="line">        - -jar</span><br><span class="line">        - app.jar</span><br><span class="line">        env:</span><br><span class="line">        - name: POD_NAMESPACE</span><br><span class="line">          valueFrom:</span><br><span class="line">            fieldRef:</span><br><span class="line">              apiVersion: v1</span><br><span class="line">              fieldPath: metadata.namespace</span><br><span class="line">        - name: POD_NAME</span><br><span class="line">          valueFrom:</span><br><span class="line">            fieldRef:</span><br><span class="line">              apiVersion: v1</span><br><span class="line">              fieldPath: metadata.name</span><br><span class="line">        - name: POD_IP</span><br><span class="line">          valueFrom:</span><br><span class="line">            fieldRef:</span><br><span class="line">              apiVersion: v1</span><br><span class="line">              fieldPath: status.podIP</span><br><span class="line">        - name: NODE_NAME</span><br><span class="line">          valueFrom:</span><br><span class="line">            fieldRef:</span><br><span class="line">              apiVersion: v1</span><br><span class="line">              fieldPath: spec.nodeName</span><br><span class="line">        envFrom:</span><br><span class="line">        - configMapRef:</span><br><span class="line">            name: console-dev.log-search.v19</span><br><span class="line">        image: registry.jiankunking.net/console_gitlab/log-search:v1.0.30-v2</span><br><span class="line">        imagePullPolicy: Always</span><br><span class="line">        name: c0</span><br><span class="line">        readinessProbe:</span><br><span class="line">          failureThreshold: 3</span><br><span class="line">          httpGet:</span><br><span class="line">            path: /api/v1/cat/test</span><br><span class="line">            port: 8080</span><br><span class="line">            scheme: HTTP</span><br><span class="line">          initialDelaySeconds: 60</span><br><span class="line">          periodSeconds: 10</span><br><span class="line">          successThreshold: 1</span><br><span class="line">          timeoutSeconds: 1</span><br><span class="line">        resources:</span><br><span class="line">          limits:</span><br><span class="line">            cpu: 300m</span><br><span class="line">            memory: 800Mi</span><br><span class="line">          requests:</span><br><span class="line">            cpu: 100m</span><br><span class="line">            memory: 500Mi</span><br><span class="line">        securityContext:</span><br><span class="line">          privileged: false</span><br><span class="line">          procMount: Default</span><br><span class="line">        terminationMessagePath: /dev/termination-log</span><br><span class="line">        terminationMessagePolicy: File</span><br><span class="line">      dnsPolicy: ClusterFirst</span><br><span class="line">      restartPolicy: Always</span><br><span class="line">      schedulerName: default-scheduler</span><br><span class="line">      securityContext:</span><br><span class="line">        runAsNonRoot: false</span><br><span class="line">      terminationGracePeriodSeconds: 30</span><br><span class="line">status:</span><br><span class="line">  availableReplicas: 2</span><br><span class="line">  fullyLabeledReplicas: 2</span><br><span class="line">  observedGeneration: 6</span><br><span class="line">  readyReplicas: 2</span><br><span class="line">  replicas: 2</span><br></pre></td></tr></table></figure>
<p>从ReplicaSet定义中可以看到该ReplicaSet是由Deployment:log-search，下面看一下其定义：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: extensions/v1beta1</span><br><span class="line">kind: Deployment</span><br><span class="line">metadata:</span><br><span class="line">  annotations:</span><br><span class="line">    deployment.kubernetes.io/revision: &quot;111&quot;</span><br><span class="line">    helm.sh/namespace: console-dev</span><br><span class="line">    helm.sh/path: app</span><br><span class="line">    helm.sh/release: log-search</span><br><span class="line">  creationTimestamp: 2020-01-15T10:20:58Z</span><br><span class="line">  generation: 168</span><br><span class="line">  labels:</span><br><span class="line">    app: log-search</span><br><span class="line">    controller.jiankunking.io/chart: app</span><br><span class="line">    controller.jiankunking.io/release: log-search</span><br><span class="line">    version: v1</span><br><span class="line">  name: log-search</span><br><span class="line">  namespace: console-dev</span><br><span class="line">  ownerReferences:</span><br><span class="line">  - apiVersion: release.jiankunking.io/v1alpha1</span><br><span class="line">    kind: Release</span><br><span class="line">    name: log-search</span><br><span class="line">    uid: b8b26af0-3780-11ea-b6c2-20677ce70b1c</span><br><span class="line">  resourceVersion: &quot;261129635&quot;</span><br><span class="line">  selfLink: /apis/extensions/v1beta1/namespaces/console-dev/deployments/log-search</span><br><span class="line">  uid: b8c61330-3780-11ea-b6c2-20677ce70b1c</span><br><span class="line">spec:</span><br><span class="line">  progressDeadlineSeconds: 600</span><br><span class="line">  replicas: 2</span><br><span class="line">  revisionHistoryLimit: 10</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      app: log-search</span><br><span class="line">      controller.jiankunking.io/chart: app</span><br><span class="line">      controller.jiankunking.io/name: log-search</span><br><span class="line">      controller.jiankunking.io/release: log-search</span><br><span class="line">      version: v1</span><br><span class="line">  strategy:</span><br><span class="line">    rollingUpdate:</span><br><span class="line">      maxSurge: 1</span><br><span class="line">      maxUnavailable: 0</span><br><span class="line">    type: RollingUpdate</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      annotations:</span><br><span class="line">        helm.sh/namespace: console-dev</span><br><span class="line">        helm.sh/path: app</span><br><span class="line">        helm.sh/release: log-search</span><br><span class="line">        v1.multus-cni.io/default-network: k8s-pod-network</span><br><span class="line">      creationTimestamp: null</span><br><span class="line">      labels:</span><br><span class="line">        app: log-search</span><br><span class="line">        controller.jiankunking.io/chart: app</span><br><span class="line">        controller.jiankunking.io/name: log-search</span><br><span class="line">        controller.jiankunking.io/release: log-search</span><br><span class="line">        version: v1</span><br><span class="line">    spec:</span><br><span class="line">      containers:</span><br><span class="line">      - command:</span><br><span class="line">        - java</span><br><span class="line">        - -server</span><br><span class="line">        - -XX:+UseZGC</span><br><span class="line">        - -Xmx400m</span><br><span class="line">        - -jar</span><br><span class="line">        - app.jar</span><br><span class="line">        env:</span><br><span class="line">        - name: POD_NAMESPACE</span><br><span class="line">          valueFrom:</span><br><span class="line">            fieldRef:</span><br><span class="line">              apiVersion: v1</span><br><span class="line">              fieldPath: metadata.namespace</span><br><span class="line">        - name: POD_NAME</span><br><span class="line">          valueFrom:</span><br><span class="line">            fieldRef:</span><br><span class="line">              apiVersion: v1</span><br><span class="line">              fieldPath: metadata.name</span><br><span class="line">        - name: POD_IP</span><br><span class="line">          valueFrom:</span><br><span class="line">            fieldRef:</span><br><span class="line">              apiVersion: v1</span><br><span class="line">              fieldPath: status.podIP</span><br><span class="line">        - name: NODE_NAME</span><br><span class="line">          valueFrom:</span><br><span class="line">            fieldRef:</span><br><span class="line">              apiVersion: v1</span><br><span class="line">              fieldPath: spec.nodeName</span><br><span class="line">        envFrom:</span><br><span class="line">        - configMapRef:</span><br><span class="line">            name: console-dev.log-search.v19</span><br><span class="line">        image: registry.jiankunking.net/console_gitlab/log-search:v1.0.30-v2</span><br><span class="line">        imagePullPolicy: Always</span><br><span class="line">        name: c0</span><br><span class="line">        readinessProbe:</span><br><span class="line">          failureThreshold: 3</span><br><span class="line">          httpGet:</span><br><span class="line">            path: /api/v1/cat/test</span><br><span class="line">            port: 8080</span><br><span class="line">            scheme: HTTP</span><br><span class="line">          initialDelaySeconds: 60</span><br><span class="line">          periodSeconds: 10</span><br><span class="line">          successThreshold: 1</span><br><span class="line">          timeoutSeconds: 1</span><br><span class="line">        resources:</span><br><span class="line">          limits:</span><br><span class="line">            cpu: 300m</span><br><span class="line">            memory: 800Mi</span><br><span class="line">          requests:</span><br><span class="line">            cpu: 100m</span><br><span class="line">            memory: 500Mi</span><br><span class="line">        securityContext:</span><br><span class="line">          privileged: false</span><br><span class="line">          procMount: Default</span><br><span class="line">        terminationMessagePath: /dev/termination-log</span><br><span class="line">        terminationMessagePolicy: File</span><br><span class="line">      dnsPolicy: ClusterFirst</span><br><span class="line">      restartPolicy: Always</span><br><span class="line">      schedulerName: default-scheduler</span><br><span class="line">      securityContext:</span><br><span class="line">        runAsNonRoot: false</span><br><span class="line">      terminationGracePeriodSeconds: 30</span><br><span class="line">status:</span><br><span class="line">  availableReplicas: 2</span><br><span class="line">  conditions:</span><br><span class="line">  - lastTransitionTime: 2021-02-26T02:15:37Z</span><br><span class="line">    lastUpdateTime: 2021-03-26T03:15:15Z</span><br><span class="line">    message: ReplicaSet &quot;log-search-67847b4fb4&quot; has successfully progressed.</span><br><span class="line">    reason: NewReplicaSetAvailable</span><br><span class="line">    status: &quot;True&quot;</span><br><span class="line">    type: Progressing</span><br><span class="line">  - lastTransitionTime: 2021-03-26T03:17:10Z</span><br><span class="line">    lastUpdateTime: 2021-03-26T03:17:10Z</span><br><span class="line">    message: Deployment has minimum availability.</span><br><span class="line">    reason: MinimumReplicasAvailable</span><br><span class="line">    status: &quot;True&quot;</span><br><span class="line">    type: Available</span><br><span class="line">  observedGeneration: 168</span><br><span class="line">  readyReplicas: 2</span><br><span class="line">  replicas: 2</span><br><span class="line">  updatedReplicas: 2</span><br></pre></td></tr></table></figure>
<p>从Deployment定义中可以看到该Deployment是由Release:log-search，下面看一下其的定义：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: release.jiankunking.io/v1alpha1</span><br><span class="line">kind: Release</span><br><span class="line">metadata:</span><br><span class="line">  annotations:</span><br><span class="line">    release.jiankunking.io/alias: log-search</span><br><span class="line">    release.jiankunking.io/lastOperation: updating</span><br><span class="line">  creationTimestamp: 2020-01-15T10:20:58Z</span><br><span class="line">  generation: 1</span><br><span class="line">  labels:</span><br><span class="line">    release.jiankunking.io/kind: deployments</span><br><span class="line">  name: log-search</span><br><span class="line">  namespace: console-dev</span><br><span class="line">  resourceVersion: &quot;261129634&quot;</span><br><span class="line">  selfLink: /apis/release.jiankunking.io/v1alpha1/namespaces/console-dev/releases/log-search</span><br><span class="line">  uid: b8b26af0-3780-11ea-b6c2-20677ce70b1c</span><br><span class="line">spec:</span><br><span class="line">  config: &apos;&#123;&quot;_config&quot;:&#123;&quot;_metadata&quot;:&#123;&quot;name&quot;:&quot;app&quot;,&quot;version&quot;:&quot;1.0.0&quot;,&quot;description&quot;:&quot;&quot;&#125;,&quot;controllers&quot;:[&#123;&quot;type&quot;:&quot;Deployment&quot;,&quot;controller&quot;:&#123;&quot;replica&quot;:1,&quot;ready&quot;:0,&quot;name&quot;:&quot;log-search&quot;,&quot;strategy&quot;:&#123;&quot;type&quot;:&quot;RollingUpdate&quot;,&quot;unavailable&quot;:0,&quot;surge&quot;:1&#125;&#125;,&quot;pod&quot;:&#123;&quot;restart&quot;:&quot;Always&quot;,&quot;dns&quot;:&quot;ClusterFirst&quot;,&quot;hostname&quot;:&quot;&quot;,&quot;subdomain&quot;:&quot;&quot;,&quot;termination&quot;:30,&quot;isPrivilege&quot;:false,&quot;securityContext&quot;:&#123;&quot;runAsNonRoot&quot;:false&#125;,&quot;hostAliases&quot;:[],&quot;host&quot;:&#123;&quot;network&quot;:false,&quot;pid&quot;:false,&quot;ipc&quot;:false&#125;,&quot;__isMonitor&quot;:false,&quot;annotations&quot;:[&#123;&quot;key&quot;:&quot;v1.multus-cni.io/default-network&quot;,&quot;value&quot;:&quot;k8s-pod-network&quot;&#125;]&#125;,&quot;schedule&quot;:&#123;&#125;,&quot;containers&quot;:[&#123;&quot;env&quot;:[],&quot;envFrom&quot;:[&#123;&quot;type&quot;:&quot;Config&quot;,&quot;name&quot;:&quot;console-dev.log-search.v19&quot;,&quot;__key&quot;:&quot;CMDB_URL&quot;&#125;],&quot;mounts&quot;:[],&quot;command&quot;:[&quot;java&quot;,&quot;-server&quot;,&quot;-XX:+UseZGC&quot;,&quot;-Xmx400m&quot;,&quot;-jar&quot;,&quot;app.jar&quot;],&quot;args&quot;:[],&quot;lifecycle&quot;:&#123;&#125;,&quot;__isEnvCustom&quot;:false,&quot;__isEnvFrom&quot;:true,&quot;__isLog&quot;:false,&quot;__isMountFile&quot;:false,&quot;__liveness&quot;:false,&quot;__readiness&quot;:true,&quot;image&quot;:&quot;registry.jiankunking.net/console_gitlab/log-search:v1.0.30-v2&quot;,&quot;imagePullPolicy&quot;:&quot;Always&quot;,&quot;name&quot;:&quot;c0&quot;,&quot;probe&quot;:&#123;&quot;readiness&quot;:&#123;&quot;handler&quot;:&#123;&quot;type&quot;:&quot;HTTP&quot;,&quot;method&quot;:&#123;&quot;scheme&quot;:&quot;HTTP&quot;,&quot;host&quot;:&quot;&quot;,&quot;port&quot;:&quot;8080&quot;,&quot;path&quot;:&quot;/api/v1/cat/test&quot;&#125;&#125;,&quot;delay&quot;:60,&quot;timeout&quot;:1,&quot;period&quot;:10,&quot;threshold&quot;:&#123;&quot;success&quot;:1,&quot;failure&quot;:3&#125;&#125;&#125;,&quot;resources&quot;:&#123;&quot;limits&quot;:&#123;&quot;cpu&quot;:&quot;0.3&quot;,&quot;memory&quot;:&quot;800Mi&quot;&#125;,&quot;requests&quot;:&#123;&quot;cpu&quot;:&quot;0.1&quot;,&quot;memory&quot;:&quot;500Mi&quot;&#125;&#125;,&quot;securityContext&quot;:&#123;&quot;privileged&quot;:false&#125;&#125;],&quot;volumes&quot;:[],&quot;initContainers&quot;:[],&quot;services&quot;:[&#123;&quot;type&quot;:&quot;ClusterIP&quot;,&quot;name&quot;:&quot;log-search&quot;,&quot;ports&quot;:[&#123;&quot;protocol&quot;:&quot;HTTP&quot;,&quot;targetPort&quot;:8080,&quot;port&quot;:8080,&quot;nodePort&quot;:0&#125;]&#125;]&#125;]&#125;&#125;&apos;</span><br><span class="line">  template: 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</span><br><span class="line">status:</span><br><span class="line">  conditions:</span><br><span class="line">  - lastTransitionTime: 2021-03-26T03:14:05Z</span><br><span class="line">    reason: Available</span><br><span class="line">    status: &quot;True&quot;</span><br><span class="line">    type: Available</span><br><span class="line">  details:</span><br><span class="line">    app:</span><br><span class="line">      path: app</span><br><span class="line">      resources:</span><br><span class="line">        /v1, Kind=Service:</span><br><span class="line">          Running: 1</span><br><span class="line">        apps/v1, Kind=Deployment:</span><br><span class="line">          Running: 1</span><br><span class="line">  lastUpdateTime: 2021-03-26T03:14:05Z</span><br><span class="line">  manifest: |-</span><br><span class="line">    apiVersion: apps/v1</span><br><span class="line">    kind: Deployment</span><br><span class="line">    metadata:</span><br><span class="line">      annotations:</span><br><span class="line">        helm.sh/namespace: console-dev</span><br><span class="line">        helm.sh/path: app</span><br><span class="line">        helm.sh/release: log-search</span><br><span class="line">      creationTimestamp: null</span><br><span class="line">      labels:</span><br><span class="line">        app: log-search</span><br><span class="line">        controller.jiankunking.io/chart: app</span><br><span class="line">        controller.jiankunking.io/release: log-search</span><br><span class="line">        version: v1</span><br><span class="line">      name: log-search</span><br><span class="line">    spec:</span><br><span class="line">      replicas: 1</span><br><span class="line">      selector:</span><br><span class="line">        matchLabels:</span><br><span class="line">          app: log-search</span><br><span class="line">          controller.jiankunking.io/chart: app</span><br><span class="line">          controller.jiankunking.io/name: log-search</span><br><span class="line">          controller.jiankunking.io/release: log-search</span><br><span class="line">          version: v1</span><br><span class="line">      strategy:</span><br><span class="line">        rollingUpdate:</span><br><span class="line">          maxSurge: 1</span><br><span class="line">          maxUnavailable: 0</span><br><span class="line">        type: RollingUpdate</span><br><span class="line">      template:</span><br><span class="line">        metadata:</span><br><span class="line">          annotations:</span><br><span class="line">            helm.sh/namespace: console-dev</span><br><span class="line">            helm.sh/path: app</span><br><span class="line">            helm.sh/release: log-search</span><br><span class="line">            v1.multus-cni.io/default-network: k8s-pod-network</span><br><span class="line">          creationTimestamp: null</span><br><span class="line">          labels:</span><br><span class="line">            app: log-search</span><br><span class="line">            controller.jiankunking.io/chart: app</span><br><span class="line">            controller.jiankunking.io/name: log-search</span><br><span class="line">            controller.jiankunking.io/release: log-search</span><br><span class="line">            version: v1</span><br><span class="line">        spec:</span><br><span class="line">          containers:</span><br><span class="line">          - command:</span><br><span class="line">            - java</span><br><span class="line">            - -server</span><br><span class="line">            - -XX:+UseZGC</span><br><span class="line">            - -Xmx400m</span><br><span class="line">            - -jar</span><br><span class="line">            - app.jar</span><br><span class="line">            env:</span><br><span class="line">            - name: POD_NAMESPACE</span><br><span class="line">              valueFrom:</span><br><span class="line">                fieldRef:</span><br><span class="line">                  fieldPath: metadata.namespace</span><br><span class="line">            - name: POD_NAME</span><br><span class="line">              valueFrom:</span><br><span class="line">                fieldRef:</span><br><span class="line">                  fieldPath: metadata.name</span><br><span class="line">            - name: POD_IP</span><br><span class="line">              valueFrom:</span><br><span class="line">                fieldRef:</span><br><span class="line">                  fieldPath: status.podIP</span><br><span class="line">            - name: NODE_NAME</span><br><span class="line">              valueFrom:</span><br><span class="line">                fieldRef:</span><br><span class="line">                  fieldPath: spec.nodeName</span><br><span class="line">            envFrom:</span><br><span class="line">            - configMapRef:</span><br><span class="line">                name: console-dev.log-search.v19</span><br><span class="line">            image: registry.jiankunking.net/console_gitlab/log-search:v1.0.30-v2</span><br><span class="line">            imagePullPolicy: Always</span><br><span class="line">            name: c0</span><br><span class="line">            readinessProbe:</span><br><span class="line">              failureThreshold: 3</span><br><span class="line">              httpGet:</span><br><span class="line">                path: /api/v1/cat/test</span><br><span class="line">                port: 8080</span><br><span class="line">                scheme: HTTP</span><br><span class="line">              initialDelaySeconds: 60</span><br><span class="line">              periodSeconds: 10</span><br><span class="line">              successThreshold: 1</span><br><span class="line">              timeoutSeconds: 1</span><br><span class="line">            resources:</span><br><span class="line">              limits:</span><br><span class="line">                cpu: 300m</span><br><span class="line">                memory: 800Mi</span><br><span class="line">              requests:</span><br><span class="line">                cpu: 100m</span><br><span class="line">                memory: 500Mi</span><br><span class="line">            securityContext:</span><br><span class="line">              privileged: false</span><br><span class="line">          dnsPolicy: ClusterFirst</span><br><span class="line">          restartPolicy: Always</span><br><span class="line">          securityContext:</span><br><span class="line">            runAsNonRoot: false</span><br><span class="line">          terminationGracePeriodSeconds: 30</span><br><span class="line">    status: &#123;&#125;</span><br><span class="line">    ---</span><br><span class="line">    apiVersion: v1</span><br><span class="line">    kind: Service</span><br><span class="line">    metadata:</span><br><span class="line">      annotations:</span><br><span class="line">        helm.sh/namespace: console-dev</span><br><span class="line">        helm.sh/path: app</span><br><span class="line">        helm.sh/release: log-search</span><br><span class="line">      creationTimestamp: null</span><br><span class="line">      labels:</span><br><span class="line">        app: log-search</span><br><span class="line">        controller.jiankunking.io/chart: app</span><br><span class="line">        controller.jiankunking.io/release: log-search</span><br><span class="line">        version: v1</span><br><span class="line">      name: log-search</span><br><span class="line">    spec:</span><br><span class="line">      ports:</span><br><span class="line">      - name: http-8080</span><br><span class="line">        port: 8080</span><br><span class="line">        protocol: TCP</span><br><span class="line">        targetPort: 8080</span><br><span class="line">      selector:</span><br><span class="line">        controller.jiankunking.io/name: log-search</span><br><span class="line">      type: ClusterIP</span><br><span class="line">    status:</span><br><span class="line">      loadBalancer: &#123;&#125;</span><br><span class="line">  podStatistics:</span><br><span class="line">    updatedPods:</span><br><span class="line">      Running: 2</span><br><span class="line">  version: 119</span><br></pre></td></tr></table></figure>
<p>这里需要注意一下，我们k8s集群管理用的是才云的，而才云对于k8s中很多资源进行了封装，这里看到的Release就是对Deployment的封装。才云对外暴露接口是以release的维度。</p>
<p>具体可以看：<a href="https://github.com/jiankunking/charts" target="_blank" rel="noopener">https://github.com/jiankunking/charts</a></p>
<p>到这里可以看到，这些资源之间的关系是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Release -&gt; Deployment -&gt; ReplicaSet -&gt; Pod</span><br></pre></td></tr></table></figure>
<p>那么，Service与Pod是怎么关联起来了呢？下面看一下Kubernetes Service的构成：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: v1</span><br><span class="line">kind: Service</span><br><span class="line">metadata:</span><br><span class="line">  annotations:</span><br><span class="line">    helm.sh/namespace: console-dev</span><br><span class="line">    helm.sh/path: app</span><br><span class="line">    helm.sh/release: log-search</span><br><span class="line">  creationTimestamp: 2020-01-15T10:20:58Z</span><br><span class="line">  labels:</span><br><span class="line">    app: log-search</span><br><span class="line">    controller.jiankunking.io/chart: app</span><br><span class="line">    controller.jiankunking.io/release: log-search</span><br><span class="line">    version: v1</span><br><span class="line">  name: log-search</span><br><span class="line">  namespace: console-dev</span><br><span class="line">  ownerReferences:</span><br><span class="line">  - apiVersion: release.jiankunking.io/v1alpha1</span><br><span class="line">    kind: Release</span><br><span class="line">    name: log-search</span><br><span class="line">    uid: b8b26af0-3780-11ea-b6c2-20677ce70b1c</span><br><span class="line">  resourceVersion: &quot;70295244&quot;</span><br><span class="line">  selfLink: /api/v1/namespaces/console-dev/services/log-search</span><br><span class="line">  uid: b8c532b4-3780-11ea-b6c2-20677ce70b1c</span><br><span class="line">spec:</span><br><span class="line">  clusterIP: 10.230.248.17</span><br><span class="line">  ports:</span><br><span class="line">  - name: http-8080</span><br><span class="line">    port: 8080</span><br><span class="line">    protocol: TCP</span><br><span class="line">    targetPort: 8080</span><br><span class="line">  selector:</span><br><span class="line">    controller.jiankunking.io/name: log-search</span><br><span class="line">  sessionAffinity: None</span><br><span class="line">  type: ClusterIP</span><br><span class="line">status:</span><br><span class="line">  loadBalancer: &#123;&#125;</span><br></pre></td></tr></table></figure>
<p>从Kubernetes Service的构成中可以看到该Service也是由Release创建的。</p>
<p>从其yaml中可以看到Service 的 VIP 地址 10.230.248.17，你就可以访问到它所代理的 Pod 了：</p>
<ul>
<li>Labels 主要用来筛选资源和组合资源，可以使用类似于 SQL 查询 select，来根据 Label 查询相关的资源。</li>
<li>Annotations 一般是系统或者工具用来存储资源的非标示性信息，可以用来扩展资源的 spec/status 的描述</li>
</ul>
<p><a href="https://draveness.me/kubernetes-service/" target="_blank" rel="noopener">https://draveness.me/kubernetes-service/</a></p>

      </div>
      
      
      
    </div>
    

    
    
    


          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="jiankunking"
      src="/images/avatar/avatar.png">
  <p class="site-author-name" itemprop="name">jiankunking</p>
  <div class="site-description" itemprop="description">如果你来访我，我不在，请和我门外的花坐一会儿，它们很温暖，我注视他们很多很多日子了。</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">155</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">39</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">212</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/jiankunking" title="GitHub → https://github.com/jiankunking" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://blog.csdn.net/jiankunking" title="CSDN → https://blog.csdn.net/jiankunking" rel="noopener" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>CSDN</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-nd.svg" alt="Creative Commons"></a>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://blog.csdn.net/jiankunking" title="https://blog.csdn.net/jiankunking" rel="noopener" target="_blank">CSDN博客</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
  <div class="beian"><a href="https://beian.miit.gov.cn" rel="noopener" target="_blank">鲁ICP备18016400号-1 </a>
  </div>

<div class="copyright">
  
  &copy; 2019 – 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">jiankunking</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">1.2m</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/muse.js"></script>
<script src="/js/next-boot.js"></script>



  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  <script src="/js/local-search.js"></script>












  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : '5e2e6dc5bd7af549261d',
      clientSecret: 'f37069692932676f0ad9fbfecb5164aee191fe23',
      repo        : 'blog-comments',
      owner       : 'jiankunking',
      admin       : ['jiankunking'],
      id          : 'b26db35c121696db6e03d183dbacaca9',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

</body>
</html>
